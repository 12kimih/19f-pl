(* test case : write prime numbers within [2, max] *)

let max := 0 in read max;
max := max + 1;
let i := 2 in
while (i < max) do (
let j := 3 in
let is_prime := true in (
if i = 2 then
unit
else
if (i - (i / 2) * 2) = 0 then
is_prime := false
else
while (j < (i / 2)) do (
let mod := (i - (i / j) * j) in
if mod = 0 then is_prime := false else unit;
j := j + 2
)
);
if is_prime then write i else unit;
i := i + 1
)

(* Output : prints out "2\n3\n5\n..." *)